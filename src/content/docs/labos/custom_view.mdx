---
title: Odoo - Vue personnalisée
description: Odoo vue
---
import { Aside, FileTree, Tabs, TabItem, } from '@astrojs/starlight/components';

Odoo propose par défaut des vues génériques pour chaque modèle,
mais il est possible de **personnaliser leur présentation**
afin de mieux adapter l’interface à vos besoins.
Pour cela, il suffit d’ajouter un **enregistrement dans la table des vues** 
via un fichier XML chargé lors de la mise à jour du module.

## Personnalisation de la vue de détail
Vous allez modifier la **vue de détail** (appelée *vue formulaire* dans Odoo) 
pour le modèle `todo.task`.
Dans le dossier `views` de votre module, créez un nouveau fichier intitulé 
**`todo_view.xml`**.

Ce fichier contiendra la définition complète de la vue, avec la structure 
du formulaire et la disposition des champs.
Chaque élément `<group>` permet d’organiser les champs visuellement, 
tandis que les attributs comme `widget` ou `readonly` contrôlent le comportement 
de certains champs.

```xml title="views/todo_view.xml" 
<?xml version="1.0"?>
<odoo>
    <record id="view_form_todo_task" model="ir.ui.view">
        <field name="name">To-do Task Form</field>
        <field name="model">todo.task</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group name="group_top">
                        <group name="group_left">
                            <field name="name" />
                            <field name="user_id" />
                            <field name="is_done" />
                        </group>
                        <group name="group_right">
                            <field name="date_deadline" />
                            <field name="team_ids" widget="many2many_tags" />
                            <field name="active" readonly="1" />
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>
</odoo>
```

<Aside>
On peut décoder le contenu de fichier comme suit : 
- `<record id="view_form_todo_task" model="ir.ui.view">`  
  Ce bloc crée un nouvel enregistrement dans le modèle `ir.ui.view`, qui contient la définition d’une vue dans Odoo.  
  - **id** : identifiant unique de la vue.  
  - **model** : indique que cet enregistrement correspond à une vue (`ir.ui.view`).  

- `<field name="name">To-do Task Form</field>`  
  Donne un **nom lisible** à la vue.

- `<field name="model">todo.task</field>`  
  Spécifie le **modèle de données** auquel cette vue est associée.

- `<field name="arch" type="xml">...</field>`  
  Contient la **structure XML de la vue** (le formulaire à afficher).  
  C’est ici que la mise en page et les champs sont définis.

    - `<form>` : racine de la vue de détail.  
    - `<sheet>` : zone principale contenant les champs du formulaire.  
    - `<group>` : permet de regrouper visuellement les champs.  
    - **group_left** : affiche les champs `name`, `user_id` et `is_done`.  
    - **group_right** : affiche `date_deadline`, `team_ids` et `active`.

Certains champs ont des attributs spécifiques :  
- `widget="many2many_tags"` : affiche la relation *Many2many* sous forme d’étiquettes.  
- `readonly="1"` : rend le champ **non modifiable** dans cette vue.
</Aside>

Une fois ce fichier créé, vous devez **mettre à jour le fichier `__manifest__.py`** 
afin qu’Odoo charge cette nouvelle vue lors de l’installation ou de la mise à jour du module.
Dans la clé `data` du fichier `__manifest__.py`, 
ajoutez la référence au fichier `todo_view.xml`, 
**après le fichier des menus**.

```python title="__manifest__.py"  
    'data': [
        'security/ir.model.access.csv',
        'views/todo_menu.xml',
        'views/todo_view.xml',
    ],
```

Après avoir mis à jour votre module :
1. Accédez à votre module **Todos**;
1. Ouvrez le détail d’une tâche depuis la vue liste;
1. Vous constaterez que la **vue de détail** a été personnalisée 
selon la nouvelle structure définie.

Si vous souhaitez modifier cette vue en respectant un autre design,
vous pouvez consulter la documentation pour connaître les balises et widgets
implémentés par Odoo : 
[https://www.odoo.com/documentation/18.0/developer/reference/user_interface/view_architectures.html#form](https://www.odoo.com/documentation/18.0/developer/reference/user_interface/view_architectures.html#form)

<Aside icon="pencil" title="Exercice">

Détaillez selon vous l'utilité du code ci-dessous et interprétez le rôle de chaque balise.
Essayez ensuite de l'intégrer dans votre projet et vérifiez si le résultat correspond 
à votre prédiction.

```xml
<record id="view_list_todo_task" model="ir.ui.view">
    <field name="name">To-do Task Tree</field>
    <field name="model">todo.task</field>
    <field name="arch" type="xml">
        <list decoration-muted="is_done==True">
            <field name="name" />
            <field name="date_deadline" />
            <field name="is_done" />
        </list>
    </field>
</record>
```
</Aside>

## Lien vers la vue partenaire

Vous allez ajouter dans votre module un lien vers la **vue existante des partenaires** 
d’Odoo.
Pour cela, il suffit de **créer une action** qui affichera la liste et le formulaire des partenaires, 
puis de l’associer à un menu du module.

Mettez à jour le fichier XML `todo_menu.xml` pour y ajouter :
- une action `ir.actions.act_window` pour le modèle `res.partner`,  
- une option au menu **Configuration > Contacts** qui déclenche cette action.  

```xml title="views/todo_menu.xml" ins={9-13,22}
<?xml version="1.0"?>
<odoo>
    <record model="ir.actions.act_window" id="action_todo_task">
        <field name="name">To-do Task</field>
        <field name="res_model">todo.task</field>
        <field name="view_mode">list,form</field>
    </record>

    <record model="ir.actions.act_window" id="contact_list_action">
        <field name="name">Contacts</field>
        <field name="res_model">res.partner</field>
        <field name="view_mode">list,form</field>
    </record>

    <menuitem id="menu_todo_task" name="Todos">

        <menuitem id="todo_task_menu" name="Todos">
            <menuitem id="task_menu" name="Tasks" action="action_todo_task" />
        </menuitem>

        <menuitem id="configuration_menu" name="Configuration">
            <menuitem id="contact_menu" name="Contacts" action="contact_list_action" />
        </menuitem>

    </menuitem>
</odoo>
```

Après avoir mis à jour votre module, vérifiez que le **menu Configuration** 
est bien présent dans l’interface du module **Todos**.
En cliquant sur le sous-menu **Contacts**, vous accéderez désormais 
à la vue standard des partenaires Odoo.

## Extension de la vue détail des partenaires

En consultant un contact existant (par exemple *Azure Interior*), vous remarquerez 
qu’aucune information ne permet de visualiser les tâches associées à ce partenaire.
Pour corriger cela, vous allez **étendre la vue formulaire** de `res.partner` 
afin d’y afficher la liste des tâches (`todo_ids`) liées à chaque contact.

Créez un nouveau fichier dans le dossier `views` de votre module, intitulé `res_partner_view.xml`.
Ce fichier contiendra la définition d’une **vue héritée** basée sur la vue standard `base.view_partner_form`.
La vue parent est consultable sur 
[le dépôt github d'Odoo](https://github.com/odoo/odoo/blob/7c513de528c9f9fdbfc8c5fa8496c94c2c7e96a0/odoo/addons/base/views/res_partner_views.xml#L141).
Dans cette extension, vous ajouterez le champ `todo_ids` [après le champ `category_id`](https://github.com/odoo/odoo/blob/7c513de528c9f9fdbfc8c5fa8496c94c2c7e96a0/odoo/addons/base/views/res_partner_views.xml#L210).

```xml title="views/res_partner_view.xml" 
<?xml version="1.0"?>
<odoo>
    <record id="my_inherited_view" model="ir.ui.view">
      <field name="name">Add Todos to Partner Form</field>
      <field name="model">res.partner</field>
      <field name="inherit_id" ref="base.view_partner_form" />
      <field name="arch" type="xml">

        <field name="category_id" position="after">
          <field name="todo_ids" />
        </field>

      </field>
    </record>
</odoo>
```

Une fois le fichier créé, modifiez le fichier `__manifest__.py` pour qu’Odoo 
le charge lors de la mise à jour du module.
Dans la clé `data`, ajoutez la référence au fichier `res_partner_view.xml`, 
**après les fichiers de menu et de vues**.

```python title="__manifest__.py"  
    'data': [
        'security/ir.model.access.csv',
        'views/todo_menu.xml',
        'views/todo_view.xml',
        'views/res_partner_view.xml',
    ],
```

Après la mise à jour du module :
1. Accédez à votre application **Todos**;
1. Ouvrez le détail d’un partenaire existant;
1. Vous verrez que la **vue formulaire du partenaire** a été personnalisée :
un champ supplémentaire affiche désormais la **liste des tâches** associées, 
juste sous le champ *Tags*, dans la colonne de droite.
